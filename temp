async def process_log_line(line, server):
    if kill_match := REGEX_KILL.search(line):
        try:
            attacker_name = kill_match.group(1)
            steam_id = kill_match.group(2)
            weapon = kill_match.group(3)
            current_time = datetime.now(timezone.utc)

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ä—É–∂–∏–µ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
            is_rifle = False
            for weapon_pattern in RIFLE_WEAPONS.values():
                if weapon_pattern.fullmatch(weapon):
                    is_rifle = True
                    break
                elif weapon_pattern.search(weapon):
                    is_rifle = True
                    break

            if not is_rifle:
                return

            # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∏–Ω—Ç–æ–≤–æ–∫
            times = kill_tracker[steam_id]['rifle_kills']
            times.append(current_time)

            # –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏
            while times and (current_time - times[0]) > timedelta(seconds=1):
                times.popleft()

            if len(times) >= 5:
                await send_suspect_message(
                    server, 
                    attacker_name, 
                    steam_id, 
                    "Rifle weapon", 
                    weapon
                )
                times.clear()

        except Exception as e:
            logging.error(f"Kill processing error: {str(e)}")

async def send_suspect_message(server, name, steam_id, weapon_type, weapon):
    embed = discord.Embed(
        title="üö® –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –æ–≥–Ω–µ—Å—Ç—Ä–µ–ª—å–Ω—ã–º –æ—Ä—É–∂–∏–µ–º",
        color=0xFF4500,
        description=(
            f"**–ò–≥—Ä–æ–∫:** {name}\n"
            f"**SteamID:** `{steam_id}`\n"
            f"**–¢–∏–ø –æ—Ä—É–∂–∏—è:** {weapon_type}\n"
            f"**–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ—Ä—É–∂–∏–µ:** {weapon}\n"
            f"**–ù–∞—Ä—É—à–µ–Ω–∏–µ:** 5+ —É–±–∏–π—Å—Ç–≤ –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É"
        )
    )
    # ... –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
